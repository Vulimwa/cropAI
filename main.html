<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CropGuard AI - Farmer App</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="assets/css/navbar.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="min-h-screen">
  <!-- Offline Banner -->
  <div id="offlineBanner" class="hidden offline-banner px-4 py-2 text-center text-sm">
    <i class="fas fa-exclamation-triangle mr-2"></i>
    <span id="offlineText">You are currently offline. Some features may be limited.</span>
  </div>

  <div id="navbar-container"></div>
  <script>
    fetch('components/navbar.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById('navbar-container').innerHTML = html;
      });
  </script>

  <div id="settings-container"></div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      fetch('components/settings.html')
        .then(res => res.text())
        .then(html => {
          document.getElementById('settings-container').innerHTML = html;
        });
    });
  </script>
  <script src="assets/js/settings.js"></script>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-6 mt-navbar">
    
    <!-- Weather Widget -->
    <div class="mb-8">
      <div class="card p-4 flex flex-col md:flex-row justify-between items-center">
        <div class="flex items-center mb-3 md:mb-0">
          <i class="fas fa-cloud-sun text-3xl text-yellow-500 mr-3"></i>
          <div>
            <h3 class="font-semibold" id="weatherLocation">Your Location</h3>
            <p class="text-gray-600"><span id="weatherTemp">--Â°C</span>, <span id="weatherCondition">--</span></p>
          </div>
        </div>
        <div class="flex items-center">
          <i class="fas fa-tint text-blue-500 mr-1"></i>
          <span class="mr-3" id="weatherHumidity">Humidity: --%</span>
          <i class="fas fa-wind text-gray-500 mr-1"></i>
          <span id="weatherWind">Wind: -- km/h</span>
        </div>
      </div>
      
      <div id="weatherAlert" class="hidden weather-alert mt-2 p-3 rounded-lg">
        <div class="flex items-center">
          <i class="fas fa-exclamation-circle text-yellow-600 mr-2"></i>
          <p class="text-sm font-medium" id="alertText">Current humidity and temperature conditions favor disease development. Consider preventive measures.</p>
        </div>
      </div>
    </div>

    <!-- Upload Section -->
    <section class="mb-8">
      <div class="card p-6 text-center leaf-pattern">
        <h2 class="text-xl font-bold mb-4" id="uploadTitle">Scan Your Plant</h2>
        <p class="mb-6 text-gray-600" id="uploadDescription">Take or upload a photo of a plant leaf to detect disease and get treatment recommendations.</p>
        
        <div class="flex justify-center gap-4 flex-wrap">
          <label for="photoInput" class="custom-file-upload btn-primary px-6 py-3 rounded-lg flex items-center" style="background:#19ad50; color:#fff;">
            <i class="fas fa-upload mr-2"></i>
            <span id="uploadBtnText">Upload Photo</span>
          </label>
          <input type="file" id="photoInput" accept="image/*">
          
          <button id="cameraBtn" class="btn-secondary px-6 py-3 rounded-lg flex items-center">
            <i class="fas fa-camera mr-2"></i>
            <span id="cameraBtnText">Take Photo</span>
          </button>
        </div>
      </div>
    </section>

    <!-- Diagnosis Result (Initially Hidden) -->
    <section id="diagnosisSection" class="mb-8 hidden">
      <div class="card p-6">
        <!-- Loading State -->
        <div id="loadingState" class="py-8 flex flex-col items-center">
          <div class="spinner mb-4"></div>
          <p class="text-gray-600" id="analyzingText">Analyzing your plant...</p>
        </div>
        
        <!-- Results State -->
        <div id="resultsState" class="hidden">
          <div class="flex flex-col md:flex-row gap-6">
            <div class="md:w-1/3">
              <div class="rounded-lg overflow-hidden bg-gray-100 h-64 flex items-center justify-center">
                <img id="diagnosisImage" class="max-h-full max-w-full object-contain" src="" alt="Plant leaf image">
              </div>
              <div class="mt-3 text-center">
                <span class="inline-block bg-green-100 text-green-800 text-sm px-3 py-1 rounded-full">
                  <i class="fas fa-check-circle mr-1"></i>
                  <span id="confidenceText">95% Confidence</span>
                </span>
              </div>
            </div>
            
            <div class="md:w-2/3">
              <h3 class="text-xl font-bold mb-2" id="diseaseNameTitle">Disease Detection Result</h3>
              <p class="text-2xl font-bold text-red-600 mb-4" id="diseaseName">--</p>
              
              <h4 class="font-semibold mb-2" id="treatmentTitle">Treatment Recommendations:</h4>
              <ul class="space-y-2 mb-4" id="treatmentList">
                <!-- Treatment steps will go here -->
              </ul>
              
              <h4 class="font-semibold mb-2" id="tipsTitle">Farming Tips:</h4>
              <ul class="space-y-1 mb-4 text-gray-700" id="tipsList">
                <!-- Tips will go here -->
              </ul>
              
              <div class="flex mt-6">
                <button class="btn-secondary px-4 py-2 rounded-lg mr-3">
                  <i class="fas fa-save mr-1"></i>
                  <span id="saveBtnText">Save Result</span>
                </button>
                <button class="btn-primary px-4 py-2 rounded-lg">
                  <i class="fas fa-share-alt mr-1"></i>
                  <span id="shareBtnText">Share</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Tabs Navigation -->
    <div class="border-b border-gray-200 mb-6">
      <div class="flex">
        <button class="tab-active py-3 px-6" id="historyTab">
          <i class="fas fa-history mr-2"></i>
          <span id="historyTabText">History</span>
        </button>
        <button class="py-3 px-6 text-gray-500" id="communityTab">
          <i class="fas fa-users mr-2"></i>
          <span id="communityTabText">Community Forum</span>
        </button>
      </div>
    </div>

    <!-- History Section -->
    <section id="historySection" class="mb-8">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold" id="historyTitle">Scan History</h2>
        <button class="text-sm text-gray-500">
          <i class="fas fa-trash-alt mr-1"></i>
          <span id="clearHistoryText">Clear History</span>
        </button>
      </div>
      
      <div id="noHistory" class="text-center py-12 text-gray-500">
        <i class="fas fa-seedling text-5xl mb-3 text-gray-400"></i>
        <p id="noHistoryText">Your scan history will appear here.</p>
      </div>
      
      <div id="historyItems" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 history-grid">
        <!-- History items will go here -->
      </div>
    </section>

    <!-- Community Forum Section (Initially Hidden) -->
    <section id="communitySection" class="mb-8 hidden">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold" id="communityTitle">Community Forum</h2>
        <button class="btn-primary px-4 py-2 rounded-lg">
          <i class="fas fa-plus mr-1"></i>
          <span id="newPostText">New Post</span>
        </button>
      </div>
      
      <div id="noPostsMessage" class="text-center py-12 text-gray-500">
        <i class="fas fa-comments text-5xl mb-3 text-gray-400"></i>
        <p id="noPostsText">Be the first to start a discussion!</p>
      </div>
      
      <div id="communityPosts" class="space-y-4">
        <!-- Community posts will go here -->
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-6">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-4 md:mb-0">
          <div class="flex items-center">
            <i class="fas fa-leaf text-green-400 mr-2"></i>
            <h2 class="text-lg font-bold">CropGuard AI</h2>
          </div>
          <p class="text-sm text-gray-400" id="footerTagline">Empowering farmers with AI technology</p>
        </div>
        
        <div class="flex space-x-4">
          <a href="javascript:void(0)" class="hover:text-green-400">
            <i class="fas fa-info-circle mr-1"></i>
            <span id="aboutLinkText">About</span>
          </a>
          <a href="javascript:void(0)" class="hover:text-green-400">
            <i class="fas fa-question-circle mr-1"></i>
            <span id="helpLinkText">Help</span>
          </a>
          <a href="javascript:void(0)" class="hover:text-green-400">
            <i class="fas fa-envelope mr-1"></i>
            <span id="contactLinkText">Contact</span>
          </a>
        </div>
      </div>
      <div class="mt-4 text-center text-sm text-gray-400">
        <p id="copyrightText">&copy; 2025 CropGuard AI. All rights reserved to Senator Sammy.</p>
      </div>
    </div>
  </footer>

  <!-- Settings Modal (Initially Hidden) -->
  <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
    <div class="bg-white rounded-lg max-w-md w-full p-6">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold" id="settingsTitle">Settings</h2>
        <button id="closeSettings" class="text-gray-500 hover:text-gray-700">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="mb-4">
        <h3 class="font-semibold mb-2" id="notificationTitle">Notifications</h3>
        <div class="flex items-center">
          <label class="inline-flex items-center cursor-pointer">
            <input type="checkbox" id="notificationToggle" class="sr-only peer">
            <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
            <span class="ml-3 text-sm font-medium text-gray-900" id="notificationText">Seasonal threat notifications</span>
          </label>
        </div>
      </div>
      
      <div class="mb-4">
        <h3 class="font-semibold mb-2" id="dataStorageTitle">Data Storage</h3>
        <div class="flex items-center">
          <label class="inline-flex items-center cursor-pointer">
            <input type="checkbox" id="storageToggle" class="sr-only peer" checked>
            <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
            <span class="ml-3 text-sm font-medium text-gray-900" id="dataStorageText">Store scan history locally</span>
          </label>
        </div>
      </div>
      
      <div class="mb-4">
        <h3 class="font-semibold mb-2" id="aboutTitle">About CropGuard AI</h3>
        <p class="text-sm text-gray-600" id="aboutText">
          CropGuard AI is an AI-powered tool that helps farmers identify plant diseases and get treatment recommendations. Version 1.0.
        </p>
      </div>
      
      <button class="btn-primary w-full py-2 rounded-lg mt-2" id="saveSettingsBtn">
        <span id="saveSettingsText">Save Settings</span>
      </button>
    </div>
  </div>

  <!-- Camera Modal (Initially Hidden) -->
  <div id="cameraModal" class="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center hidden">
    <div class="max-w-lg w-full p-4">
      <div class="bg-white rounded-lg overflow-hidden">
        <div class="p-4 bg-gray-100 flex justify-between items-center">
          <h3 class="font-bold" id="cameraModalTitle">Take a Photo</h3>
          <button id="closeCamera" class="text-gray-500 hover:text-gray-700">
            <i class="fas fa-times"></i>
          </button>
        </div>
        
        <div class="relative">
          <video id="cameraFeed" class="w-full h-64 bg-black" autoplay muted></video>
          <canvas id="captureCanvas" class="hidden"></canvas>
        </div>
        
        <div class="p-4 flex justify-center">
          <button id="takePictureBtn" class="btn-primary rounded-full w-16 h-16 flex items-center justify-center">
            <i class="fas fa-camera text-xl"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
  <script id="app-script" src="/assets/js/main.js"></script>
</body>
</html>

