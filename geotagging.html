<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CropAI | Geo Mapping</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- Maplibre GL JS -->
    <link href="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.css" rel="stylesheet" />
    <script src="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.js"></script>
</head>
<body>
    <!-- Overlay for navbar (for mobile nav reveal) -->
    <div id="nav-overlay" class="nav-overlay"></div>
    <!-- Top Navbar (loaded dynamically) -->
    <div id="navbar-container"></div>
    <!-- Main Split Layout -->
    <main class="main-layout mt-navbar">
        <!-- Map Section -->
        <section class="map-section">
            <div id="map" class="map-container"></div>
            <!-- Floating Action Buttons (FABs) -->
            <div class="fab-group">
                <button class="fab" id="fab-add" title="Add new outbreak"></button>
                <button class="fab" id="fab-locate" title="Locate my farm"></button>
                <button class="fab" id="fab-filters" title="Toggle filters"></button>
                <!-- Basemap Switcher -->
                <div class="basemap-switcher" id="basemap-switcher">
                    <!-- Basemap options will be dynamically generated by JS -->
                </div>
            </div>
        </section>
        <!-- Side Panel for Outbreaks (not navigation) -->
        <aside class="side-panel" id="side-panel">
            <header class="panel-header">
                <h2>Tagged Outbreaks</h2>
                <!-- Export/Share button -->
                <button class="export-btn" id="export-btn">Export</button>
            </header>
            <!-- Filter Bar -->
            <div class="filter-bar">
                <select id="filter-disease">
                    <option value="">All Diseases</option>
                    <option value="maize_rust">Maize Rust</option>
                    <option value="blight">Blight</option>
                    <!-- Add more as needed -->
                </select>
                <input type="date" id="filter-date-start" placeholder="Start date">
                <input type="date" id="filter-date-end" placeholder="End date">
                <select id="filter-severity">
                    <option value="">All Severities</option>
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                </select>
                <input type="search" id="filter-search" placeholder="Search...">
            </div>
            <!-- Outbreaks List -->
            <div class="outbreaks-list" id="outbreaks-list">
                <!-- Outbreak cards will be dynamically rendered here by JS -->
                <!-- Backend: Populate with outbreak data -->
            </div>
        </aside>
    </main>
    <!-- Modal placeholders for add/edit outbreak, details, confirmation, etc. -->
    <div id="modal-container" class="modal-container">
        <!-- Modals will be injected here by JS -->
        <!-- Backend: Use for add/edit outbreak, details, etc. -->
    </div>
    <script>
    // Dynamically load the navbar component and update navigation links
    fetch('components/navbar.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById('navbar-container').innerHTML = html;
        // Fix navigation links for SPA-like navigation
        const navLinks = document.querySelectorAll('.nav-links a');
        navLinks.forEach(link => {
          link.addEventListener('click', function(e) {
            if (this.getAttribute('href') === 'index.html') {
              window.location.href = 'index.html';
            } else if (this.getAttribute('href') === 'geotagging.html') {
              window.location.href = 'geotagging.html';
            } // add more if needed
          });
        });
      });
    </script>
    <script src="assets/js/geotagging.js"></script>
</body>
</html>
